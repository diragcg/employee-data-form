<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>संचालनालय कृषि छत्तीसगढ़</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <!-- Mukta Devanagari Font -->
    <link href="https://fonts.googleapis.com/css2?family=Mukta:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Forest Green & Cream Theme */
            --primary-color: #1B5E20;     /* Dark Forest Green */
            --secondary-color: #388E3C;   /* Medium Green */
            --accent-color: #8BC34A;      /* Light Green */
            --text-dark: #263238;
            --text-medium: #455A64;
            --text-light: #FFF8E1;        /* Cream */
            --background-light: #FFF8E1;  /* Cream */
            --background-medium: #F1F8E9; /* Light Green-Cream */
            --border-color: #C8E6C9;      /* Light Green Border */
            --shadow-sm: 0 2px 4px rgba(0, 0, 0, 0.05);
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --shadow-md: 0 6px 12px rgba(0, 0, 0, 0.15);
            --shadow-lg: 0 8px 24px rgba(27, 94, 32, 0.2);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Mukta', sans-serif;
            background-color: var(--background-light);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Hindi text styling */
        .hindi {
            font-weight: 500;
            letter-spacing: 0.3px;
            line-height: 1.5;
        }
        
        /* Header and Navbar Styles */
        .header {
            background-color: var(--primary-color);
            box-shadow: var(--shadow);
            position: relative;
            z-index: 100;
        }
        
        .navbar {
            padding: 12px 0;
        }
        
        .navbar-brand {
            font-weight: 700;
            font-size: 1.5rem;
            color: var(--text-light);
            display: flex;
            align-items: center;
        }
        
        .navbar-brand img {
            height: 45px;
            margin-right: 15px;
            filter: drop-shadow(0 2px 3px rgba(0, 0, 0, 0.2));
        }
        
        .nav-link {
            font-family: 'Mukta', sans-serif;
            color: rgba(255, 248, 225, 0.9) !important;
            font-weight: 600;
            padding: 12px 20px !important;
            margin: 0 5px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            color: var(--text-light) !important;
            background-color: rgba(255, 248, 225, 0.1);
        }
        
        .nav-link.active {
            color: var(--text-light) !important;
            background-color: rgba(255, 248, 225, 0.2);
        }
        
        /* Login Container */
        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: calc(100vh - 80px);
            padding: 60px 20px;
        }
        
        /* Card Styles */
        .card {
            width: 100%;
            max-width: 480px;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow-lg);
            border: none;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            background-color: #FFFFFF;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(27, 94, 32, 0.25);
        }
        
        .card-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: var(--text-light);
            padding: 30px 40px;
            border-bottom: none;
            position: relative;
            overflow: hidden;
        }
        
        .card-header::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 150px;
            height: 150px;
            background: radial-gradient(circle, var(--accent-color) 0%, transparent 70%);
            opacity: 0.2;
            border-radius: 50%;
            transform: translate(50%, -50%);
        }
        
        .card-header h2 {
            font-weight: 700;
            margin-bottom: 10px;
            font-size: 2rem;
            position: relative;
            z-index: 1;
        }
        
        .card-header p {
            font-weight: 500;
            margin-bottom: 0;
            opacity: 0.9;
            position: relative;
            z-index: 1;
        }
        
        .card-body {
            padding: 40px;
            background-color: #FFFFFF;
        }
        
        /* Form Styles */
        .form-label {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
            font-size: 1.05rem;
        }
        
        .form-control {
            height: 54px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            padding: 12px 18px;
            font-size: 1.05rem;
            transition: all 0.3s ease;
            background-color: #F9FBF7;
            font-family: 'Mukta', sans-serif;
        }
        
        .form-control:focus {
            border-color: var(--secondary-color);
            background-color: #FFFFFF;
            box-shadow: 0 0 0 3px rgba(56, 142, 60, 0.15);
        }
        
        .input-group-text {
            border-radius: 0 10px 10px 0;
            background-color: var(--background-medium);
            border-color: var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
            width: 50px;
            justify-content: center;
            color: var(--primary-color);
        }
        
        .input-group-text:hover {
            background-color: var(--border-color);
        }
        
        .input-group .form-control {
            border-radius: 10px 0 0 10px;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
            height: 54px;
            font-weight: 700;
            border-radius: 10px;
            font-size: 1.1rem;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(27, 94, 32, 0.2);
            padding: 0 24px;
        }
        
        .btn-primary:hover {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
            box-shadow: 0 6px 15px rgba(27, 94, 32, 0.3);
            transform: translateY(-2px);
        }
        
        .btn-primary:active {
            transform: translateY(1px);
        }
        
        .form-check {
            padding-left: 1.8rem;
        }
        
        .form-check-input {
            width: 1.1rem;
            height: 1.1rem;
            margin-top: 0.25rem;
        }
        
        .form-check-input:checked {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        /* Alert Styles */
        .alert {
            border-radius: 10px;
            font-weight: 500;
            padding: 16px;
            margin-bottom: 25px;
            box-shadow: var(--shadow-sm);
        }
        
        .alert-success {
            background-color: #E8F5E9;
            border-color: #C8E6C9;
            color: #2E7D32;
        }
        
        .alert-danger {
            background-color: #FFEBEE;
            border-color: #FFCDD2;
            color: #C62828;
        }
        
        /* Footer Styles */
        .auth-footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(200, 230, 201, 0.5);
            color: var(--text-medium);
            font-weight: 500;
        }
        
        .auth-link {
            color: var(--secondary-color);
            font-weight: 700;
            text-decoration: none;
            transition: all 0.3s ease;
        }
        
        .auth-link:hover {
            color: var(--primary-color);
            text-decoration: underline;
        }
        
        /* Modal Styles */
        .modal-content {
            border-radius: 16px;
            border: none;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
        }
        
        .modal-header {
            background-color: var(--primary-color);
            color: var(--text-light);
            border-bottom: none;
            padding: 20px 30px;
        }
        
        .modal-title {
            font-weight: 700;
            font-size: 1.3rem;
        }
        
        .btn-close {
            filter: brightness(0) invert(1);
            opacity: 0.8;
        }
        
        .modal-body {
            padding: 30px;
            background-color: #FFFFFF;
        }
        
        .modal-body h6 {
            color: var(--primary-color);
            margin-top: 15px;
            margin-bottom: 10px;
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .modal-body h6:first-child {
            margin-top: 0;
        }
        
        .modal-body p {
            font-size: 1rem;
            line-height: 1.5;
        }
        
        .modal-footer {
            border-top: none;
            padding: 20px 30px;
            background-color: #FAFAFA;
        }
        
        /* Service cards */
        .service-card {
            border: none;
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            height: 100%;
            box-shadow: var(--shadow);
            background-color: #FFFFFF;
        }
        
        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-md);
        }
        
        .service-card .card-body {
            padding: 25px;
        }
        
        .service-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 65px;
            height: 65px;
            border-radius: 50%;
            background-color: #E8F5E9;
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.5rem;
        }
        
        .service-card h5 {
            font-weight: 700;
            margin-bottom: 12px;
            color: var(--primary-color);
            font-size: 1.25rem;
        }
        
        .service-card p {
            font-size: 1rem;
            color: var(--text-medium);
            margin-bottom: 0;
        }
        
        /* Animation for fade in/out */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        /* Leaf decoration */
        .leaf-decoration {
            position: absolute;
            width: 120px;
            height: 120px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%238BC34A' opacity='0.1'%3E%3Cpath d='M17,8C8,10,5.9,16.17,3.82,21.34L5.71,22l1-2.3A4.49,4.49,0,0,0,8,20a4.35,4.35,0,0,0,4.11-2.72c.69,0,1.37,0,2-.12a4.35,4.35,0,0,0,4.11-2.72c.53,0,1,0,1.53-.09A4.31,4.31,0,0,0,22,12.5,2.31,2.31,0,0,0,19.5,10Z'/%3E%3C/svg%3E");
            background-size: contain;
            background-repeat: no-repeat;
            z-index: 0;
            opacity: 0.2;
        }
        
        .leaf-top-right {
            top: -20px;
            right: -20px;
            transform: rotate(45deg);
        }
        
        .leaf-bottom-left {
            bottom: -20px;
            left: -20px;
            transform: rotate(225deg);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .navbar-brand {
                font-size: 1.3rem;
            }
            
            .navbar-brand img {
                height: 35px;
            }
            
            .card-header {
                padding: 25px 30px;
            }
            
            .card-body {
                padding: 30px 25px;
            }
            
            .card-header h2 {
                font-size: 1.8rem;
            }
            
            .form-control, .btn-primary {
                height: 50px;
            }
        }
        
        @media (max-width: 576px) {
            .login-container {
                padding: 30px 15px;
            }
        }
    </style>
</head>
<body>
    <!-- Header with Interactive Navbar -->
    <header class="header">
        <div class="container">
            <nav class="navbar navbar-expand-lg navbar-dark">
                <div class="container-fluid">
                    <a class="navbar-brand" href="#">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/5/55/Emblem_of_India.svg" alt="भारत सरकार">
                        <span class="hindi">संचालनालय कृषि छत्तीसगढ़</span>
                    </a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-expanded="false">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav ms-auto">
                            <li class="nav-item">
                                <a class="nav-link active hindi" href="#">मुख्य पृष्ठ</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link hindi" href="#" id="servicesLink">सेवाएं</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link hindi" href="#" id="contactLink">संपर्क करें</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link hindi" href="#" data-bs-toggle="modal" data-bs-target="#helpModal">
                                    <i class="fas fa-question-circle me-1"></i> सहायता
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <!-- Login Container -->
    <div class="login-container">
        <div class="card">
            <div class="card-header position-relative">
                <div class="leaf-decoration leaf-top-right"></div>
                <h2 class="hindi">लॉगिन करें</h2>
                <p class="hindi">अपने खाते में प्रवेश करें</p>
            </div>
            <div class="card-body position-relative">
                <div class="leaf-decoration leaf-bottom-left"></div>
                <div id="alertBox" class="alert" style="display: none;"></div>
                
                <form id="loginForm">
                    <div class="mb-4">
                        <label for="username" class="form-label hindi">यूजरनेम</label>
                        <input type="text" class="form-control" id="username" placeholder="अपना यूजरनेम दर्ज करें" required>
                    </div>
                    <div class="mb-4">
                        <label for="password" class="form-label hindi">पासवर्ड</label>
                        <div class="input-group">
                            <input type="password" class="form-control" id="password" placeholder="अपना पासवर्ड दर्ज करें" required>
                            <span class="input-group-text" id="togglePassword">
                                <i class="fas fa-eye-slash"></i>
                            </span>
                        </div>
                    </div>
                    <div class="mb-4 form-check">
                        <input type="checkbox" class="form-check-input" id="rememberMe">
                        <label class="form-check-label hindi" for="rememberMe">मुझे याद रखें</label>
                    </div>
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-sign-in-alt me-2"></i> <span class="hindi">लॉगिन करें</span>
                    </button>
                </form>
                
                <div class="auth-footer">
                    <p class="hindi">अकाउंट नहीं है? <a href="register.html" class="auth-link hindi">रजिस्टर करें</a></p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Help Modal -->
    <div class="modal fade" id="helpModal" tabindex="-1" aria-labelledby="helpModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title hindi" id="helpModalLabel">लॉगिन सहायता</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <h6 class="fw-bold hindi">लॉगिन कैसे करें?</h6>
                    <p class="hindi">अपना यूजरनेम और पासवर्ड दर्ज करें और लॉगिन बटन पर क्लिक करें।</p>
                    
                    <h6 class="fw-bold hindi">पासवर्ड भूल गए?</h6>
                    <p class="hindi">कृपया प्रशासक से संपर्क करें।</p>
                    
                    <h6 class="fw-bold hindi">तकनीकी सहायता</h6>
                    <p class="hindi">किसी भी समस्या के लिए, कृपया हमें <strong>diagri-cg@cg.gov.in</strong> पर ईमेल करें या <strong>9399207068</strong> पर कॉल करें।</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary hindi" data-bs-dismiss="modal">समझ गया</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Services Modal -->
    <div class="modal fade" id="servicesModal" tabindex="-1" aria-labelledby="servicesModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title hindi" id="servicesModalLabel">हमारी सेवाएं</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <div class="service-card">
                                <div class="card-body text-center">
                                    <div class="service-icon">
                                        <i class="fas fa-map-marked-alt"></i>
                                    </div>
                                    <h5 class="hindi">कृषि मैपर एप्प</h5>
                                    <p class="hindi">खेतों और फसलों के मैपिंग के लिए आधुनिक मोबाइल एप्लिकेशन</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="service-card">
                                <div class="card-body text-center">
                                    <div class="service-icon">
                                        <i class="fas fa-globe"></i>
                                    </div>
                                    <h5 class="hindi">ग्राउंड ट्रुथ मैपिंग</h5>
                                    <p class="hindi">फसल क्षेत्र और उत्पादन के लिए सटीक भू-स्थानिक मैपिंग सेवाएं</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="service-card">
                                <div class="card-body text-center">
                                    <div class="service-icon">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                    <h5 class="hindi">डेटा वैलिडेशन सेवाएं</h5>
                                    <p class="hindi">कृषि डेटा की सत्यापन और प्रमाणीकरण सेवाएं</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary hindi" data-bs-dismiss="modal">बंद करें</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Contact Modal -->
    <div class="modal fade" id="contactModal" tabindex="-1" aria-labelledby="contactModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title hindi" id="contactModalLabel">संपर्क करें</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-4">
                        <h6 class="fw-bold hindi"><i class="fas fa-map-marker-alt me-2" style="color: var(--primary-color);"></i> पता</h6>
                        <p class="hindi">संचालनालय कृषि छत्तीसगढ़<br>रायपुर, छत्तीसगढ़ - 492001</p>
                    </div>
                    
                    <div class="mb-4">
                        <h6 class="fw-bold hindi"><i class="fas fa-phone-alt me-2" style="color: var(--primary-color);"></i> फोन नंबर</h6>
                        <p class="hindi">9399207068 (श्री शैलेंद्र सिंह चौहान)<br>7354900500 (श्रीमती शिल्पा जांगड़े)</p>
                    </div>
                    
                    <div class="mb-4">
                        <h6 class="fw-bold hindi"><i class="fas fa-envelope me-2" style="color: var(--primary-color);"></i> ईमेल</h6>
                        <p class="hindi">diagri-cg@cg.gov.in</p>
                    </div>
                    
                    <div>
                        <h6 class="fw-bold hindi"><i class="fas fa-clock me-2" style="color: var(--primary-color);"></i> कार्यालय समय</h6>
                        <p class="hindi">सोमवार से शुक्रवार: सुबह 10:00 बजे से शाम 5:00 बजे तक</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary hindi" data-bs-dismiss="modal">बंद करें</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.38.4/dist/umd/supabase.min.js"></script>
    <script>
        // Supabase configuration
        const supabaseUrl = 'https://txjbfqrbbtvzlxpeegkv.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR4amJmcXJiYnR2emx4cGVlZ2t2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTMxMTU2NTQsImV4cCI6MjA2ODY5MTY1NH0.sE5UbwEOSnd9ED-k_Ix5OfdZbf7dmwlHZSjQQrEAyCo';
        
        // Initialize Supabase client
        const { createClient } = supabase;
        const supabaseClient = createClient(supabaseUrl, supabaseKey);

        // Show alert message
        function showAlert(message, type) {
            const alertBox = document.getElementById('alertBox');
            alertBox.textContent = message;
            alertBox.className = `alert alert-\${type} hindi`;
            alertBox.style.display = 'block';
            
            // Add animation
            alertBox.style.animation = 'fadeIn 0.3s';
            
            // Auto hide after 5 seconds
            setTimeout(() => {
                alertBox.style.animation = 'fadeOut 0.3s';
                setTimeout(() => {
                    alertBox.style.display = 'none';
                }, 300);
            }, 5000);
        }

        // Hash password with SHA-256
        async function hashPassword(password) {
            const encoder = new TextEncoder();
            const data = encoder.encode(password);
            const hashBuffer = await crypto.subtle.digest('SHA-256', data);
            const hashArray = Array.from(new Uint8Array(hashBuffer));
            return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        }

        // Toggle password visibility
        document.getElementById('togglePassword').addEventListener('click', function() {
            const passwordInput = document.getElementById('password');
            const icon = this.querySelector('i');
            
            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                icon.classList.remove('fa-eye-slash');
                icon.classList.add('fa-eye');
            } else {
                passwordInput.type = 'password';
                icon.classList.remove('fa-eye');
                icon.classList.add('fa-eye-slash');
            }
        });
        
        // Services link handler
        document.getElementById('servicesLink').addEventListener('click', function(e) {
            e.preventDefault();
            const servicesModal = new bootstrap.Modal(document.getElementById('servicesModal'));
            servicesModal.show();
        });
        
        // Contact link handler
        document.getElementById('contactLink').addEventListener('click', function(e) {
            e.preventDefault();
            const contactModal = new bootstrap.Modal(document.getElementById('contactModal'));
            contactModal.show();
        });
// Handle login form submission
document.getElementById('loginForm').addEventListener('submit', async function(event) {
    event.preventDefault();
    
    try {
        // Show loading state
        const submitBtn = this.querySelector('button[type="submit"]');
        const originalBtnText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span> <span class="hindi">प्रवेश हो रहा है...</span>';
        submitBtn.disabled = true;
        
        // Get form values
        const username = document.getElementById('username').value;
        const password = document.getElementById('password').value;
        const rememberMe = document.getElementById('rememberMe').checked;
        
        // Hash the password
        const hashedPassword = await hashPassword(password);
        
        // Check user credentials
        const { data, error } = await supabaseClient
            .from('test_users')
            .select('id, username, full_name, role')
            .eq('username', username)
            .eq('password_hash', hashedPassword)
            .eq('is_active', true)
            .single();
        
        if (error) {
            throw new Error('अमान्य यूजरनेम या पासवर्ड');
        }
        
        if (!data) {
            throw new Error('अमान्य यूजरनेम या पासवर्ड');
        }
        
        // Update last login time
        await supabaseClient
            .from('test_users')
            .update({ last_login: new Date().toISOString() })
            .eq('id', data.id);
        
        // Save user data to storage
        const userData = {
            id: data.id,
            username: data.username,
            fullName: data.full_name,
            role: data.role
        };
        
        // Use localStorage if rememberMe is checked, otherwise sessionStorage
        if (rememberMe) {
            localStorage.setItem('user', JSON.stringify(userData));
        } else {
            sessionStorage.setItem('user', JSON.stringify(userData));
        }
        
        // Show success message
        showAlert('लॉगिन सफल! पुनर्निर्देशित किया जा रहा है...', 'success');
        
        // Redirect to dashboard
        setTimeout(() => {
            window.location.href = 'dashboard.html';
        }, 1500);
        
    } catch (error) {
        console.error('Login error:', error);
        showAlert(error.message || 'लॉगिन विफल। कृपया पुनः प्रयास करें।', 'danger');
        
        // Reset button
        const submitBtn = document.querySelector('button[type="submit"]');
        submitBtn.innerHTML = '<i class="fas fa-sign-in-alt me-2"></i> <span class="hindi">लॉगिन करें</span>';
        submitBtn.disabled = false;
    }
});

// Check for existing login
document.addEventListener('DOMContentLoaded', function() {
    // Check localStorage and sessionStorage for existing user
    const storedUser = localStorage.getItem('user') || sessionStorage.getItem('user');
    
    if (storedUser) {
        // User is already logged in, redirect to dashboard
        window.location.href = 'dashboard.html';
    }
});

// Add visual feedback for form elements
const formInputs = document.querySelectorAll('.form-control');
formInputs.forEach(input => {
    // Add focus animation
    input.addEventListener('focus', function() {
        this.parentElement.classList.add('input-focused');
    });
    
    // Remove focus animation
    input.addEventListener('blur', function() {
        this.parentElement.classList.remove('input-focused');
    });
    
    // Validate on input
    input.addEventListener('input', function() {
        if (this.value.trim() !== '') {
            this.classList.add('is-valid');
        } else {
            this.classList.remove('is-valid');
        }
    });
});

// Add floating leaf animations
function createLeafElements() {
    const loginContainer = document.querySelector('.login-container');
    
    for (let i = 0; i < 5; i++) {
        const leaf = document.createElement('div');
        leaf.className = 'floating-leaf';
        leaf.style.left = `${Math.random() * 100}%`;
        leaf.style.top = `${Math.random() * 100}%`;
        leaf.style.animationDelay = `${Math.random() * 10}s`;
        leaf.style.transform = `rotate(${Math.random() * 360}deg) scale(${0.6 + Math.random() * 0.4})`;
        loginContainer.appendChild(leaf);
    }
}

// Initialize leaf animations
createLeafElements();

// Add custom styles for floating leaves
const styleSheet = document.createElement('style');
styleSheet.textContent = `
    .floating-leaf {
        position: absolute;
        width: 40px;
        height: 40px;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%231B5E20' opacity='0.07'%3E%3Cpath d='M17,8C8,10,5.9,16.17,3.82,21.34L5.71,22l1-2.3A4.49,4.49,0,0,0,8,20a4.35,4.35,0,0,0,4.11-2.72c.69,0,1.37,0,2-.12a4.35,4.35,0,0,0,4.11-2.72c.53,0,1,0,1.53-.09A4.31,4.31,0,0,0,22,12.5,2.31,2.31,0,0,0,19.5,10Z'/%3E%3C/svg%3E");
        background-size: contain;
        background-repeat: no-repeat;
        pointer-events: none;
        z-index: 0;
        animation: floatLeaf 20s linear infinite;
    }
    
    @keyframes floatLeaf {
        0% {
            transform: translateY(0) rotate(0) scale(0.8);
            opacity: 0;
        }
        10% {
            opacity: 0.1;
        }
        90% {
            opacity: 0.1;
        }
        100% {
            transform: translateY(-100vh) rotate(360deg) scale(1);
            opacity: 0;
        }
    }
    
    .input-focused {
        position: relative;
    }
    
    .input-focused::after {
        content: '';
        position: absolute;
        bottom: -2px;
        left: 0;
        width: 100%;
        height: 2px;
        background-color: var(--secondary-color);
        animation: expandLine 0.3s ease forwards;
        transform-origin: center;
    }
    
    @keyframes expandLine {
        0% {
            transform: scaleX(0);
        }
        100% {
            transform: scaleX(1);
        }
    }
`;
document.head.appendChild(styleSheet);

// Add accessibility features
document.querySelectorAll('input, button').forEach(element => {
    if (!element.getAttribute('aria-label')) {
        if (element.id === 'username') {
            element.setAttribute('aria-label', 'यूजरनेम इनपुट फील्ड');
        } else if (element.id === 'password') {
            element.setAttribute('aria-label', 'पासवर्ड इनपुट फील्ड');
        } else if (element.id === 'rememberMe') {
            element.setAttribute('aria-label', 'मुझे याद रखें चेकबॉक्स');
        }
    }
});

// Add form validation
const loginForm = document.getElementById('loginForm');
loginForm.setAttribute('novalidate', '');

loginForm.addEventListener('submit', function(event) {
    if (!this.checkValidity()) {
        event.preventDefault();
        event.stopPropagation();
        
        // Show validation messages
        const username = document.getElementById('username');
        const password = document.getElementById('password');
        
        if (!username.value.trim()) {
            showInputError(username, 'कृपया अपना यूजरनेम दर्ज करें');
        }
        
        if (!password.value.trim()) {
            showInputError(password, 'कृपया अपना पासवर्ड दर्ज करें');
        }
    }
    
    this.classList.add('was-validated');
});

// Function to show input errors
function showInputError(inputElement, message) {
    // Remove any existing error message
    const existingError = inputElement.parentElement.querySelector('.invalid-feedback');
    if (existingError) {
        existingError.remove();
    }
    
    // Add new error message
    const errorDiv = document.createElement('div');
    errorDiv.className = 'invalid-feedback';
    errorDiv.textContent = message;
    
    if (inputElement.parentElement.classList.contains('input-group')) {
        inputElement.parentElement.after(errorDiv);
    } else {
        inputElement.after(errorDiv);
    }
    
    // Add invalid class
    inputElement.classList.add('is-invalid');
    
    // Remove invalid class after user starts typing
    inputElement.addEventListener('input', function() {
        if (this.value.trim() !== '') {
            this.classList.remove('is-invalid');
        }
    }, { once: true });
}

// Add theme switcher
function addThemeSwitcher() {
    const header = document.querySelector('.header');
    const themeButton = document.createElement('button');
    themeButton.className = 'theme-switcher';
    themeButton.innerHTML = '<i class="fas fa-adjust"></i>';
    themeButton.setAttribute('aria-label', 'थीम बदलें');
    themeButton.title = 'थीम बदलें';
    
    // Add theme switcher styles
    const themeStyles = document.createElement('style');
    themeStyles.textContent = `
        .theme-switcher {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-color);
            color: var(--text-light);
            border: none;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .theme-switcher:hover {
            transform: scale(1.1);
            background-color: var(--secondary-color);
        }
        
        body.dark-theme {
            --background-light: #1E2A38;
            --background-medium: #2C3A47;
            --text-dark: #F5F5F5;
            --text-medium: #E0E0E0;
            --border-color: #455A64;
        }
        
        body.dark-theme .card {
            background-color: #2C3A47;
        }
        
        body.dark-theme .form-control {
            background-color: #1E2A38;
            color: #F5F5F5;
            border-color: #455A64;
        }
        
        body.dark-theme .form-control::placeholder {
            color: #90A4AE;
        }
        
        body.dark-theme .auth-footer {
            color: #B0BEC5;
        }
    `;
    document.head.appendChild(themeStyles);
    
    document.body.appendChild(themeButton);
    
    // Theme switcher functionality
    themeButton.addEventListener('click', function() {
        document.body.classList.toggle('dark-theme');
        
        // Save preference
        if (document.body.classList.contains('dark-theme')) {
            localStorage.setItem('theme', 'dark');
        } else {
            localStorage.setItem('theme', 'light');
        }
    });
    
    // Check for saved theme preference
    const savedTheme = localStorage.getItem('theme');
    if (savedTheme === 'dark') {
        document.body.classList.add('dark-theme');
    }
}

// Initialize theme switcher
addThemeSwitcher();

// Add language switcher
function addLanguageSwitcher() {
    // Create language switch button
    const langButton = document.createElement('button');
    langButton.className = 'language-switcher';
    langButton.innerHTML = 'EN | हिंदी';
    langButton.setAttribute('aria-label', 'भाषा बदलें');
    langButton.title = 'भाषा बदलें';
    
    // Add language switcher styles
    const langStyles = document.createElement('style');
    langStyles.textContent = `
        .language-switcher {
            position: fixed;
            bottom: 20px;
            left: 20px;
            padding: 8px 16px;
            border-radius: 25px;
            background-color: var(--primary-color);
            color: var(--text-light);
            border: none;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .language-switcher:hover {
            transform: translateY(-2px);
            background-color: var(--secondary-color);
        }
        
        [data-lang="en"] .hindi-content {
            display: none;
        }
        
        [data-lang="en"] .english-content {
            display: block;
        }
        
        [data-lang="hi"] .hindi-content {
            display: block;
        }
        
        [data-lang="hi"] .english-content {
            display: none;
        }
    `;
    document.head.appendChild(langStyles);
    
    document.body.appendChild(langButton);
    
    // Set default language
    document.body.setAttribute('data-lang', 'hi');
    
    // Language switcher functionality
    langButton.addEventListener('click', function() {
        const currentLang = document.body.getAttribute('data-lang');
        const newLang = currentLang === 'hi' ? 'en' : 'hi';
        
        document.body.setAttribute('data-lang', newLang);
        localStorage.setItem('language', newLang);
        
        // Update button text
        langButton.innerHTML = newLang === 'hi' ? 'EN | हिंदी' : 'हिंदी | EN';
        
        // Update content based on language
        updateLanguageContent(newLang);
    });
    
    // Check for saved language preference
    const savedLang = localStorage.getItem('language');
    if (savedLang) {
        document.body.setAttribute('data-lang', savedLang);
        langButton.innerHTML = savedLang === 'hi' ? 'EN | हिंदी' : 'हिंदी | EN';
        updateLanguageContent(savedLang);
    }
}

// Function to update content based on language
function updateLanguageContent(lang) {
    const translations = {
        'hi': {
            'login_heading': 'लॉगिन करें',
            'login_subheading': 'अपने खाते में प्रवेश करें',
            'username_label': 'यूजरनेम',
            'username_placeholder': 'अपना यूजरनेम दर्ज करें',
            'password_label': 'पासवर्ड',
            'password_placeholder': 'अपना पासवर्ड दर्ज करें',
            'remember_me': 'मुझे याद रखें',
            'login_button': '<i class="fas fa-sign-in-alt me-2"></i> लॉगिन करें',
            'no_account': 'अकाउंट नहीं है?',
            'register': 'रजिस्टर करें',
            'login_success': 'लॉगिन सफल! पुनर्निर्देशित किया जा रहा है...',
            'login_failed': 'लॉगिन विफल। कृपया पुनः प्रयास करें।',
            'invalid_credentials': 'अमान्य यूजरनेम या पासवर्ड',
            'logging_in': '<span class="spinner-border spinner-border-sm me-2"></span> प्रवेश हो रहा है...'
        },
        'en': {
            'login_heading': 'Login',
            'login_subheading': 'Access your account',
            'username_label': 'Username',
            'username_placeholder': 'Enter your username',
            'password_label': 'Password',
            'password_placeholder': 'Enter your password',
            'remember_me': 'Remember me',
            'login_button': '<i class="fas fa-sign-in-alt me-2"></i> Login',
            'no_account': 'Don\'t have an account?',
            'register': 'Register',
            'login_success': 'Login successful! Redirecting...',
            'login_failed': 'Login failed. Please try again.',
            'invalid_credentials': 'Invalid username or password',
            'logging_in': '<span class="spinner-border spinner-border-sm me-2"></span> Logging in...'
        }
    };
    
    // Update text content
    document.querySelector('.card-header h2').textContent = translations[lang].login_heading;
    document.querySelector('.card-header p').textContent = translations[lang].login_subheading;
    document.querySelector('label[for="username"]').textContent = translations[lang].username_label;
    document.getElementById('username').placeholder = translations[lang].username_placeholder;
    document.querySelector('label[for="password"]').textContent = translations[lang].password_label;
    document.getElementById('password').placeholder = translations[lang].password_placeholder;
    document.querySelector('label[for="rememberMe"]').textContent = translations[lang].remember_me;
    document.querySelector('button[type="submit"]').innerHTML = translations[lang].login_button;
    document.querySelector('.auth-footer p').innerHTML = 
        `${translations[lang].no_account} <a href="register.html" class="auth-link">${translations[lang].register}</a>`;
}

// Initialize language switcher
addLanguageSwitcher();

// Add notification system
function setupNotificationSystem() {
    // Create notification container
    const notifContainer = document.createElement('div');
    notifContainer.className = 'notification-container';
    
    // Add notification styles
    const notifStyles = document.createElement('style');
    notifStyles.textContent = `
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 300px;
            max-width: 90%;
            z-index: 2000;
        }
        
        .notification {
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            display: flex;
            align-items: center;
            transform: translateX(120%);
            transition: transform 0.3s ease;
            background-color: #FFFFFF;
            border-left: 4px solid var(--primary-color);
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification-icon {
            margin-right: 15px;
            width: 24px;
            height: 24px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
        }
        
        .notification-content {
            flex-grow: 1;
        }
        
        .notification-title {
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--text-dark);
        }
        
        .notification-message {
            font-size: 0.9rem;
            color: var(--text-medium);
            margin: 0;
        }
        
        .notification-close {
            background: none;
            border: none;
            color: #9E9E9E;
            cursor: pointer;
            padding: 5px;
            margin-left: 10px;
            font-size: 1rem;
            transition: color 0.2s;
        }
        
        .notification-close:hover {
            color: #616161;
        }
        
        .notification-success {
            border-left-color: #4CAF50;
        }
        
        .notification-success .notification-icon {
            color: #4CAF50;
        }
        
        .notification-error {
            border-left-color: #F44336;
        }
        
        .notification-error .notification-icon {
            color: #F44336;
        }
        
        .notification-info {
            border-left-color: #2196F3;
        }
        
        .notification-info .notification-icon {
            color: #2196F3;
        }
        
        .notification-warning {
            border-left-color: #FF9800;
        }
        
        .notification-warning .notification-icon {
            color: #FF9800;
        }
    `;
    document.head.appendChild(notifStyles);
    document.body.appendChild(notifContainer);
    
    // Function to show notifications
    window.showNotification = function(title, message, type = 'info', duration = 5000) {
        // Create notification element
        const notification = document.createElement('div');
        notification.className = `notification notification-${type}`;
        
        // Get icon based on type
        let icon = 'info-circle';
        if (type === 'success') icon = 'check-circle';
        if (type === 'error') icon = 'exclamation-circle';
        if (type === 'warning') icon = 'exclamation-triangle';
        
        notification.innerHTML = `
            <div class="notification-icon">
                <i class="fas fa-${icon}"></i>
            </div>
            <div class="notification-content">
                <div class="notification-title">${title}</div>
                <p class="notification-message">${message}</p>
            </div>
            <button class="notification-close">
                <i class="fas fa-times"></i>
            </button>
        `;
        
        // Add to container
        notifContainer.appendChild(notification);
        
        // Show with animation
        setTimeout(() => {
            notification.classList.add('show');
        }, 10);
        
        // Setup close button
        const closeBtn = notification.querySelector('.notification-close');
        closeBtn.addEventListener('click', () => {
            closeNotification(notification);
        });
        
        // Auto close after duration
        if (duration > 0) {
            setTimeout(() => {
                closeNotification(notification);
            }, duration);
        }
        
        // Function to close notification
        function closeNotification(notif) {
            notif.classList.remove('show');
            setTimeout(() => {
                notif.remove();
            }, 300);
        }
    };
}

// Initialize notification system
setupNotificationSystem();

// Add security features
function enhanceFormSecurity() {
    // Add CSRF token to form
    const csrfToken = generateRandomToken();
    localStorage.setItem('csrf_token', csrfToken);
    
    const csrfInput = document.createElement('input');
    csrfInput.type = 'hidden';
    csrfInput.name = 'csrf_token';
    csrfInput.value = csrfToken;
    document.getElementById('loginForm').appendChild(csrfInput);
    
    // Add rate limiting for failed attempts
    let failedAttempts = parseInt(localStorage.getItem('failed_login_attempts') || '0');
    let lastAttemptTime = parseInt(localStorage.getItem('last_attempt_time') || '0');
    
    // Override the login form submission to add rate limiting
    const originalSubmitHandler = document.getElementById('loginForm').onsubmit;
    document.getElementById('loginForm').onsubmit = async function(event) {
        event.preventDefault();
        
        const currentTime = Date.now();
        
        // Check if user is temporarily locked out
        if (failedAttempts >= 5) {
            const timeElapsed = currentTime - lastAttemptTime;
            const lockoutDuration = 5 * 60 * 1000; // 5 minutes
            
            if (timeElapsed < lockoutDuration) {
                const remainingTime = Math.ceil((lockoutDuration - timeElapsed) / 1000 / 60);
                showNotification(
                    document.body.getAttribute('data-lang') === 'hi' ? 'अकाउंट अस्थायी रूप से लॉक है' : 'Account temporarily locked',
                    document.body.getAttribute('data-lang') === 'hi' 
                        ? `कई असफल प्रयासों के कारण आपका अकाउंट ${remainingTime} मिनट के लिए लॉक है।` 
                        : `Your account is locked for ${remainingTime} minutes due to multiple failed attempts.`,
                    'warning',
                    8000
                );
                return;
            } else {
                // Reset failed attempts after lockout period
                failedAttempts = 0;
                localStorage.setItem('failed_login_attempts', '0');
            }
        }
        
        // Update last attempt time
        lastAttemptTime = currentTime;
        localStorage.setItem('last_attempt_time', lastAttemptTime.toString());
        
        // Call the original handler via login function
        try {
            await loginUser();
            // Reset failed attempts on successful login
            failedAttempts = 0;
            localStorage.setItem('failed_login_attempts', '0');
        } catch (error) {
            // Increment failed attempts
            failedAttempts++;
            localStorage.setItem('failed_login_attempts', failedAttempts.toString());
            
            // Show appropriate message
            if (failedAttempts >= 5) {
                showNotification(
                    document.body.getAttribute('data-lang') === 'hi' ? 'अकाउंट अस्थायी रूप से लॉक है' : 'Account temporarily locked',
                    document.body.getAttribute('data-lang') === 'hi'
                        ? 'कई असफल प्रयासों के कारण आपका अकाउंट 5 मिनट के लिए लॉक है।'
                        : 'Your account is locked for 5 minutes due to multiple failed attempts.',
                    'warning',
                    8000
                );
            } else {
                const remainingAttempts = 5 - failedAttempts;
                showNotification(
                    document.body.getAttribute('data-lang') === 'hi' ? 'लॉगिन विफल' : 'Login Failed',
                    document.body.getAttribute('data-lang') === 'hi'
                        ? `${error.message}. आपके पास ${remainingAttempts} प्रयास शेष हैं।`
                        : `${error.message}. You have ${remainingAttempts} attempts remaining.`,
                    'error',
                    5000
                );
            }
        }
    };
    
    // Function to generate random token
    function generateRandomToken() {
        const array = new Uint8Array(16);
        window.crypto.getRandomValues(array);
        return Array.from(array, byte => byte.toString(16).padStart(2, '0')).join('');
    }
    
    // Actual login function
    async function loginUser() {
        // Show loading state
        const submitBtn = document.querySelector('button[type="submit"]');
        const originalBtnText = submitBtn.innerHTML;
        const loadingText = document.body.getAttribute('data-lang') === 'hi' 
            ? '<span class="spinner-border spinner-border-sm me-2"></span> <span>प्रवेश हो रहा है...</span>'
            : '<span class="spinner-border spinner-border-sm me-2"></span> <span>Logging in...</span>';
        
        submitBtn.innerHTML = loadingText;
        submitBtn.disabled = true;
        
        try {
            // Get form values
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const rememberMe = document.getElementById('rememberMe').checked;
            
            // Hash the password
            const hashedPassword = await hashPassword(password);
            
            // Check user credentials
            const { data, error } = await supabaseClient
                .from('test_users')
                .select('id, username, full_name, role')
                .eq('username', username)
                .eq('password_hash', hashedPassword)
                .eq('is_active', true)
                .single();
            
            if (error) {
                throw new Error(document.body.getAttribute('data-lang') === 'hi' 
                    ? 'अमान्य यूजरनेम या पासवर्ड' 
                    : 'Invalid username or password');
            }
            
            if (!data) {
                throw new Error(document.body.getAttribute('data-lang') === 'hi' 
                    ? 'अमान्य यूजरनेम या पासवर्ड' 
                    : 'Invalid username or password');
            }
            
            // Update last login time
            await supabaseClient
                .from('test_users')
                .update({ last_login: new Date().toISOString() })
                .eq('id', data.id);
            
            // Save user data to storage
            const userData = {
                id: data.id,
                username: data.username,
                fullName: data.full_name,
                role: data.role,
                loginTime: new Date().toISOString()
            };
            
            // Use localStorage if rememberMe is checked, otherwise sessionStorage
            if (rememberMe) {
                localStorage.setItem('user', JSON.stringify(userData));
            } else {
                sessionStorage.setItem('user', JSON.stringify(userData));
            }
            
            // Show success message
            const successMsg = document.body.getAttribute('data-lang') === 'hi'
                ? 'लॉगिन सफल! पुनर्निर्देशित किया जा रहा है...'
                : 'Login successful! Redirecting...';
                
            showNotification(
                document.body.getAttribute('data-lang') === 'hi' ? 'सफल लॉगिन' : 'Login Successful',
                successMsg,
                'success',
                2000
            );
            
            // Redirect to dashboard
            setTimeout(() => {
                window.location.href = 'dashboard.html';
            }, 1500);
            
        } catch (error) {
            console.error('Login error:', error);
            
            // Reset button
            submitBtn.innerHTML = originalBtnText;
            submitBtn.disabled = false;
            
            throw error;
        }
    }
}

// Initialize security enhancements
enhanceFormSecurity();

// Initialize the page with animations
document.addEventListener('DOMContentLoaded', function() {
    // Add page load animation
    document.body.style.opacity = '0';
    document.body.style.transition = 'opacity 0.5s ease';
    
    setTimeout(() => {
        document.body.style.opacity = '1';
    }, 100);
    
    // Add seasonal decorations
    addSeasonalDecorations();
    
    // Add accessibility features
    enhanceAccessibility();
    
    // Add analytics tracking
    setupAnalytics();
    
    // Add offline support
    setupOfflineSupport();
    
    // Add form auto-save
    setupFormAutoSave();
    
    // Add keyboard shortcuts
    setupKeyboardShortcuts();
    
    // Check browser compatibility
    checkBrowserCompatibility();
});

// Function to add seasonal decorations based on current month
function addSeasonalDecorations() {
    const currentMonth = new Date().getMonth();
    
    // Add seasonal styles
    const seasonalStyles = document.createElement('style');
    
    // Different decorations based on season
    if (currentMonth >= 3 && currentMonth <= 5) {
        // Spring theme (April-June)
        seasonalStyles.textContent = `
            .login-container::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cpath d='M20 12.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm-7 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm14 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm-7 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z' fill='%231B5E20' fill-opacity='0.05'/%3E%3C/svg%3E");
                pointer-events: none;
                z-index: -1;
            }
        `;
    } else if (currentMonth >= 6 && currentMonth <= 8) {
        // Summer theme (July-September)
        seasonalStyles.textContent = `
            .login-container::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cpath d='M20 5a15 15 0 1 0 0 30 15 15 0 0 0 0-30z' fill='%23FFD54F' fill-opacity='0.05'/%3E%3C/svg%3E");
                pointer-events: none;
                z-index: -1;
            }
        `;
    } else if (currentMonth >= 9 && currentMonth <= 11) {
        // Fall theme (October-December)
        seasonalStyles.textContent = `
            .login-container::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cpath d='M20 3.33L23.33 10h6.67l-5 5 1.67 6.67L20 18.33l-6.67 3.34L15 15l-5-5h6.67L20 3.33z' fill='%23FF9800' fill-opacity='0.05'/%3E%3C/svg%3E");
                pointer-events: none;
                z-index: -1;
            }
        `;
    } else {
        // Winter theme (January-March)
        seasonalStyles.textContent = `
            .login-container::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='40' height='40' viewBox='0 0 40 40'%3E%3Cpath d='M20 0v40M0 20h40M10 10l20 20M30 10L10 30' stroke='%231B5E20' stroke-opacity='0.05' stroke-width='1'/%3E%3C/svg%3E");
                pointer-events: none;
                z-index: -1;
            }
        `;
    }
    
    document.head.appendChild(seasonalStyles);
}

// Function to enhance accessibility
function enhanceAccessibility() {
    // Add high contrast mode toggle
    const accessibilityButton = document.createElement('button');
    accessibilityButton.className = 'accessibility-button';
    accessibilityButton.innerHTML = '<i class="fas fa-universal-access"></i>';
    accessibilityButton.setAttribute('aria-label', 'पहुंच विकल्प');
    accessibilityButton.title = 'पहुंच विकल्प / Accessibility Options';
    
    // Add accessibility styles
    const accessStyles = document.createElement('style');
    accessStyles.textContent = `
        .accessibility-button {
            position: fixed;
            bottom: 20px;
            left: 80px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            color: var(--text-light);
            border: none;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .accessibility-button:hover {
            transform: scale(1.1);
            background-color: var(--primary-color);
        }
        
        .accessibility-menu {
            position: fixed;
            bottom: 80px;
            left: 20px;
            background-color: #FFFFFF;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            padding: 15px;
            z-index: 1001;
            width: 250px;
            transform: translateY(20px);
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .accessibility-menu.show {
            transform: translateY(0);
            opacity: 1;
            visibility: visible;
        }
        
        .accessibility-menu h5 {
            margin-top: 0;
            margin-bottom: 15px;
            color: var(--primary-color);
            font-weight: 600;
            font-size: 1.1rem;
            border-bottom: 1px solid #E0E0E0;
            padding-bottom: 8px;
        }
        
        .accessibility-option {
            margin-bottom: 12px;
        }
        
        .accessibility-option label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-weight: 500;
        }
        
        .accessibility-option input {
            margin-right: 10px;
        }
        
        /* High contrast mode */
        body.high-contrast {
            --primary-color: #000000;
            --secondary-color: #000000;
            --accent-color: #FFFFFF;
            --text-dark: #000000;
            --text-medium: #000000;
            --text-light: #FFFFFF;
            --background-light: #FFFFFF;
            --background-medium: #FFFFFF;
            --border-color: #000000;
        }
        
        body.high-contrast .card {
            background-color: #FFFFFF;
            border: 2px solid #000000;
        }
        
        body.high-contrast .card-header {
            background: #000000;
        }
        
        body.high-contrast .btn-primary {
            background-color: #000000;
            border-color: #000000;
            color: #FFFFFF;
        }
        
        body.high-contrast .form-control {
            border: 2px solid #000000;
            background-color: #FFFFFF;
            color: #000000;
        }
        
        /* Large text mode */
        body.large-text {
            font-size: 1.2rem;
        }
        
        body.large-text .form-control {
            font-size: 1.2rem;
            height: 60px;
        }
        
        body.large-text .btn-primary {
            font-size: 1.2rem;
            height: 60px;
        }
        
        /* Reduce motion mode */
        body.reduce-motion * {
            animation: none !important;
            transition: none !important;
        }
    `;
    document.head.appendChild(accessStyles);
    
    // Create accessibility menu
    const accessMenu = document.createElement('div');
    accessMenu.className = 'accessibility-menu';
    accessMenu.innerHTML = `
        <h5 class="hindi">पहुंच विकल्प</h5>
        <div class="accessibility-option">
            <label>
                <input type="checkbox" id="highContrastToggle">
                <span class="hindi">उच्च कंट्रास्ट मोड</span>
            </label>
        </div>
        <div class="accessibility-option">
            <label>
                <input type="checkbox" id="largeTextToggle">
                <span class="hindi">बड़ा टेक्स्ट</span>
            </label>
        </div>
        <div class="accessibility-option">
            <label>
                <input type="checkbox" id="reduceMotionToggle">
                <span class="hindi">मोशन कम करें</span>
            </label>
        </div>
    `;
    
    document.body.appendChild(accessibilityButton);
    document.body.appendChild(accessMenu);
    
    // Toggle accessibility menu
    accessibilityButton.addEventListener('click', function() {
        accessMenu.classList.toggle('show');
    });
    
    // Close menu when clicking outside
    document.addEventListener('click', function(event) {
        if (!accessMenu.contains(event.target) && event.target !== accessibilityButton) {
            accessMenu.classList.remove('show');
        }
    });
    
    // High contrast toggle
    document.getElementById('highContrastToggle').addEventListener('change', function() {
        document.body.classList.toggle('high-contrast', this.checked);
        localStorage.setItem('high_contrast', this.checked ? 'true' : 'false');
    });
    
    // Large text toggle
    document.getElementById('largeTextToggle').addEventListener('change', function() {
        document.body.classList.toggle('large-text', this.checked);
        localStorage.setItem('large_text', this.checked ? 'true' : 'false');
    });
    
    // Reduce motion toggle
    document.getElementById('reduceMotionToggle').addEventListener('change', function() {
        document.body.classList.toggle('reduce-motion', this.checked);
        localStorage.setItem('reduce_motion', this.checked ? 'true' : 'false');
    });
    
    // Load saved accessibility preferences
    if (localStorage.getItem('high_contrast') === 'true') {
        document.getElementById('highContrastToggle').checked = true;
        document.body.classList.add('high-contrast');
    }
    
    if (localStorage.getItem('large_text') === 'true') {
        document.getElementById('largeTextToggle').checked = true;
        document.body.classList.add('large-text');
    }
    
    if (localStorage.getItem('reduce_motion') === 'true') {
        document.getElementById('reduceMotionToggle').checked = true;
        document.body.classList.add('reduce-motion');
    }
}

// Function to setup analytics
function setupAnalytics() {
    // Simple analytics tracking
    const analyticsData = {
        pageLoads: parseInt(localStorage.getItem('analytics_page_loads') || '0') + 1,
        lastVisit: new Date().toISOString(),
        userAgent: navigator.userAgent,
        screenWidth: window.innerWidth,
        screenHeight: window.innerHeight
    };
    
    localStorage.setItem('analytics_page_loads', analyticsData.pageLoads.toString());
    localStorage.setItem('analytics_last_visit', analyticsData.lastVisit);
    
    // Track form interactions
    const formInputs = document.querySelectorAll('.form-control');
    formInputs.forEach(input => {
        input.addEventListener('focus', function() {
            const fieldInteractions = JSON.parse(localStorage.getItem('analytics_field_interactions') || '{}');
            fieldInteractions[this.id] = (fieldInteractions[this.id] || 0) + 1;
            localStorage.setItem('analytics_field_interactions', JSON.stringify(fieldInteractions));
        });
    });
    
    // Track button clicks
    document.querySelector('button[type="submit"]').addEventListener('click', function() {
        const buttonClicks = parseInt(localStorage.getItem('analytics_login_clicks') || '0') + 1;
        localStorage.setItem('analytics_login_clicks', buttonClicks.toString());
    });
}

// Function to setup offline support
function setupOfflineSupport() {
    // Check online status
    window.addEventListener('online', updateOnlineStatus);
    window.addEventListener('offline', updateOnlineStatus);
    
    function updateOnlineStatus() {
        const isOnline = navigator.onLine;
        
        if (!isOnline) {
            showNotification(
                document.body.getAttribute('data-lang') === 'hi' ? 'ऑफलाइन मोड' : 'Offline Mode',
                document.body.getAttribute('data-lang') === 'hi' 
                    ? 'आप वर्तमान में ऑफलाइन हैं। इंटरनेट कनेक्शन की जांच करें।' 
                    : 'You are currently offline. Please check your internet connection.',
                'warning',
                0
            );
        } else {
            // Remove any offline notifications
            const notifications = document.querySelectorAll('.notification');
            notifications.forEach(notif => {
                if (notif.textContent.includes('ऑफलाइन') || notif.textContent.includes('Offline')) {
                    notif.remove();
                }
            });
        }
    }
    
    // Initial check
    updateOnlineStatus();
}

// Function to setup form auto-save
function setupFormAutoSave() {
    const formInputs = document.querySelectorAll('.form-control:not([type="password"])');
    
    // Load saved values
    formInputs.forEach(input => {
        const savedValue = localStorage.getItem(`autosave_${input.id}`);
        if (savedValue) {
            input.value = savedValue;
        }
    });
    
    // Save on input
    formInputs.forEach(input => {
        input.addEventListener('input', function() {
            localStorage.setItem(`autosave_${this.id}`, this.value);
        });
    });
    
    // Clear saved data on successful login
    document.getElementById('loginForm').addEventListener('submit', function() {
        formInputs.forEach(input => {
            localStorage.removeItem(`autosave_${input.id}`);
        });
    });
}

// Function to setup keyboard shortcuts
function setupKeyboardShortcuts() {
    document.addEventListener('keydown', function(event) {
        // Alt+L to focus login button
        if (event.altKey && event.key === 'l') {
            event.preventDefault();
            document.querySelector('button[type="submit"]').focus();
        }
        
        // Alt+U to focus username field
        if (event.altKey && event.key === 'u') {
            event.preventDefault();
            document.getElementById('username').focus();
        }
        
        // Alt+P to focus password field
        if (event.altKey && event.key === 'p') {
            event.preventDefault();
            document.getElementById('password').focus();
        }
        
        // Alt+H to toggle help modal
        if (event.altKey && event.key === 'h') {
            event.preventDefault();
            new bootstrap.Modal(document.getElementById('helpModal')).toggle();
        }
    });
}

// Function to check browser compatibility
function checkBrowserCompatibility() {
    const isIE = /*@cc_on!@*/false || !!document.documentMode;
    const isEdgeHTML = !isIE && !!window.StyleMedia;
    
    if (isIE || isEdgeHTML) {
        showNotification(
            document.body.getAttribute('data-lang') === 'hi' ? 'ब्राउज़र संगतता चेतावनी' : 'Browser Compatibility Warning',
            document.body.getAttribute('data-lang') === 'hi'
                ? 'आप एक पुराने ब्राउज़र का उपयोग कर रहे हैं। कृपया बेहतर अनुभव के लिए Chrome, Firefox, या Edge के नवीनतम संस्करण का उपयोग करें।'
                : 'You are using an outdated browser. Please use the latest version of Chrome, Firefox, or Edge for the best experience.',
            'warning',
            10000
        );
    }
}

// Add connection strength indicator
function addConnectionIndicator() {
    // Create connection indicator element
    const connectionIndicator = document.createElement('div');
    connectionIndicator.className = 'connection-indicator';
    connectionIndicator.innerHTML = '<i class="fas fa-wifi"></i>';
    
    // Add connection indicator styles
    const connStyles = document.createElement('style');
    connStyles.textContent = `
        .connection-indicator {
            position: fixed;
            top: 15px;
            right: 15px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: rgba(255, 255, 255, 0.8);
            color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .connection-indicator.good {
            color: #4CAF50;
        }
        
        .connection-indicator.medium {
            color: #FF9800;
        }
        
        .connection-indicator.poor {
            color: #F44336;
        }
        
        .connection-tooltip {
            position: absolute;
            top: 40px;
            right: 0;
            background-color: #FFFFFF;
            border-radius: 8px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            padding: 10px 15px;
            font-size: 0.85rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            z-index: 1001;
        }
        
        .connection-indicator:hover .connection-tooltip {
            opacity: 1;
            visibility: visible;
        }
    `;
    document.head.appendChild(connStyles);
    
    // Create tooltip
    const tooltip = document.createElement('div');
    tooltip.className = 'connection-tooltip';
    connectionIndicator.appendChild(tooltip);
    
    document.body.appendChild(connectionIndicator);
    
    // Function to update connection status
    function updateConnectionStatus() {
        // Get connection information if available
        let connectionInfo = 'Unknown';
        let connectionQuality = 'medium';
        
        if (navigator.connection) {
            const connection = navigator.connection;
            
            // Determine connection type
            let connectionType = connection.effectiveType || 'unknown';
            
            // Map connection type to quality
            switch (connectionType) {
                case '4g':
                    connectionQuality = 'good';
                    connectionInfo = document.body.getAttribute('data-lang') === 'hi' 
                        ? 'उत्कृष्ट कनेक्शन (4G)' 
                        : 'Excellent Connection (4G)';
                    break;
                case '3g':
                    connectionQuality = 'medium';
                    connectionInfo = document.body.getAttribute('data-lang') === 'hi' 
                        ? 'अच्छा कनेक्शन (3G)' 
                        : 'Good Connection (3G)';
                    break;
                case '2g':
                case 'slow-2g':
                    connectionQuality = 'poor';
                    connectionInfo = document.body.getAttribute('data-lang') === 'hi' 
                        ? 'धीमा कनेक्शन (2G)' 
                        : 'Slow Connection (2G)';
                    break;
                default:
                    connectionQuality = navigator.onLine ? 'medium' : 'poor';
                    connectionInfo = navigator.onLine 
                        ? (document.body.getAttribute('data-lang') === 'hi' ? 'ऑनलाइन' : 'Online')
                        : (document.body.getAttribute('data-lang') === 'hi' ? 'ऑफलाइन' : 'Offline');
            }
        } else {
            // Fallback if Network Information API is not available
            connectionQuality = navigator.onLine ? 'medium' : 'poor';
            connectionInfo = navigator.onLine 
                ? (document.body.getAttribute('data-lang') === 'hi' ? 'ऑनलाइन' : 'Online')
                : (document.body.getAttribute('data-lang') === 'hi' ? 'ऑफलाइन' : 'Offline');
        }
        
        // Update indicator
        connectionIndicator.className = `connection-indicator ${connectionQuality}`;
        tooltip.textContent = connectionInfo;
    }
    
    // Update status initially and on connection change
    updateConnectionStatus();
    window.addEventListener('online', updateConnectionStatus);
    window.addEventListener('offline', updateConnectionStatus);
    
    // Update on network change if supported
    if (navigator.connection && navigator.connection.addEventListener) {
        navigator.connection.addEventListener('change', updateConnectionStatus);
    }
}

// Initialize connection indicator
addConnectionIndicator();

// Add page load time measurement
function measurePagePerformance() {
    // Wait for page to fully load
    window.addEventListener('load', function() {
        setTimeout(function() {
            // Get performance timing
            if (window.performance && window.performance.timing) {
                const timing = window.performance.timing;
                const loadTime = timing.domContentLoadedEventEnd - timing.navigationStart;
                
                // Log performance data
                console.log('Page load time:', loadTime, 'ms');
                
                // Save to analytics
                const performanceData = JSON.parse(localStorage.getItem('analytics_performance') || '{}');
                performanceData.lastLoadTime = loadTime;
                performanceData.averageLoadTime = performanceData.averageLoadTime 
                    ? (performanceData.averageLoadTime * 0.8 + loadTime * 0.2) // Weighted average
                    : loadTime;
                localStorage.setItem('analytics_performance', JSON.stringify(performanceData));
            }
        }, 0);
    });
}

// Initialize performance measurement
measurePagePerformance();

// Add feedback mechanism
function addFeedbackButton() {
    // Create feedback button
    const feedbackBtn = document.createElement('button');
    feedbackBtn.className = 'feedback-button';
    feedbackBtn.innerHTML = '<i class="fas fa-comment-alt"></i>';
    feedbackBtn.setAttribute('aria-label', document.body.getAttribute('data-lang') === 'hi' ? 'फीडबैक दें' : 'Give Feedback');
    feedbackBtn.title = document.body.getAttribute('data-lang') === 'hi' ? 'फीडबैक दें' : 'Give Feedback';
    
    // Add feedback styles
    const feedbackStyles = document.createElement('style');
    feedbackStyles.textContent = `
        .feedback-button {
            position: fixed;
            bottom: 20px;
            right: 80px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--accent-color);
            color: var(--primary-color);
            border: none;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .feedback-button:hover {
            transform: scale(1.1);
            background-color: var(--secondary-color);
            color: var(--text-light);
        }
        
        .feedback-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .feedback-modal.show {
            opacity: 1;
            visibility: visible;
        }
        
        .feedback-content {
            background-color: #FFFFFF;
            border-radius: 12px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            transform: scale(0.9);
            transition: all 0.3s ease;
        }
        
        .feedback-modal.show .feedback-content {
            transform: scale(1);
        }
        
        .feedback-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .feedback-header h4 {
            margin: 0;
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .feedback-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #9E9E9E;
            transition: color 0.2s;
        }
        
        .feedback-close:hover {
            color: #616161;
        }
        
        .feedback-form textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            resize: vertical;
            min-height: 120px;
            margin-bottom: 20px;
            font-family: inherit;
        }
        
        .feedback-form textarea:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 3px rgba(27, 94, 32, 0.1);
        }
        
        .feedback-rating {
            margin-bottom: 20px;
        }
        
        .rating-stars {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .rating-star {
            font-size: 1.5rem;
            color: #E0E0E0;
            cursor: pointer;
            transition: color 0.2s;
        }
        
        .rating-star:hover, .rating-star.active {
            color: #FFD700;
        }
        
        .feedback-submit {
            background-color: var(--primary-color);
            color: #FFFFFF;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .feedback-submit:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }
    `;
    document.head.appendChild(feedbackStyles);
    
    // Create feedback modal
    const feedbackModal = document.createElement('div');
    feedbackModal.className = 'feedback-modal';
    feedbackModal.innerHTML = `
        <div class="feedback-content">
            <div class="feedback-header">
                <h4>${document.body.getAttribute('data-lang') === 'hi' ? 'आपका फीडबैक दें' : 'Give Your Feedback'}</h4>
                <button class="feedback-close">&times;</button>
            </div>
            <form class="feedback-form">
                <div class="feedback-rating">
                    <label>${document.body.getAttribute('data-lang') === 'hi' ? 'इस पेज को रेट करें:' : 'Rate this page:'}</label>
                    <div class="rating-stars">
                        <span class="rating-star" data-value="1"><i class="fas fa-star"></i></span>
                        <span class="rating-star" data-value="2"><i class="fas fa-star"></i></span>
                        <span class="rating-star" data-value="3"><i class="fas fa-star"></i></span>
                        <span class="rating-star" data-value="4"><i class="fas fa-star"></i></span>
                        <span class="rating-star" data-value="5"><i class="fas fa-star"></i></span>
                    </div>
                </div>
                <textarea placeholder="${document.body.getAttribute('data-lang') === 'hi' ? 'अपना फीडबैक यहां लिखें...' : 'Write your feedback here...'}"></textarea>
                <button type="submit" class="feedback-submit">${document.body.getAttribute('data-lang') === 'hi' ? 'सबमिट करें' : 'Submit'}</button>
            </form>
        </div>
    `;
    
    document.body.appendChild(feedbackBtn);
    document.body.appendChild(feedbackModal);
    
    // Toggle feedback modal
    feedbackBtn.addEventListener('click', function() {
        feedbackModal.classList.add('show');
    });
    
    // Close modal
    const closeBtn = feedbackModal.querySelector('.feedback-close');
    closeBtn.addEventListener('click', function() {
        feedbackModal.classList.remove('show');
    });
    
    // Close modal when clicking outside
    feedbackModal.addEventListener('click', function(event) {
        if (event.target === feedbackModal) {
            feedbackModal.classList.remove('show');
        }
    });
    
    // Star rating functionality
    const stars = feedbackModal.querySelectorAll('.rating-star');
    let selectedRating = 0;
    
    stars.forEach(star => {
        star.addEventListener('click', function() {
            const value = parseInt(this.getAttribute('data-value'));
            selectedRating = value;
            
            // Update stars
            stars.forEach(s => {
                const starValue = parseInt(s.getAttribute('data-value'));
                if (starValue <= value) {
                    s.classList.add('active');
                } else {
                    s.classList.remove('active');
                }
            });
        });
    });
    
    // Handle form submission
    const feedbackForm = feedbackModal.querySelector('.feedback-form');
    feedbackForm.addEventListener('submit', function(event) {
        event.preventDefault();
        
        const feedback = feedbackModal.querySelector('textarea').value;
        
        // Save feedback (in a real app, this would be sent to a server)
        const feedbackData = {
            rating: selectedRating,
            feedback: feedback,
            timestamp: new Date().toISOString(),
            page: 'login'
        };
        
        // For demo purposes, just store in localStorage
        const allFeedback = JSON.parse(localStorage.getItem('user_feedback') || '[]');
        allFeedback.push(feedbackData);
        localStorage.setItem('user_feedback', JSON.stringify(allFeedback));
        
        // Show thank you message
        showNotification(
            document.body.getAttribute('data-lang') === 'hi' ? 'धन्यवाद!' : 'Thank you!',
            document.body.getAttribute('data-lang') === 'hi' ? 'आपके मूल्यवान फीडबैक के लिए धन्यवाद।' : 'Thank you for your valuable feedback.',
            'success',
            3000
        );
        
        // Reset and close modal
        feedbackForm.reset();
        stars.forEach(s => s.classList.remove('active'));
        selectedRating = 0;
        feedbackModal.classList.remove('show');
    });
}

// Initialize feedback button
addFeedbackButton();

// Add social login options
function addSocialLogin() {
    const loginForm = document.getElementById('loginForm');
    
    // Create social login container
    const socialContainer = document.createElement('div');
    socialContainer.className = 'social-login';
    
    // Add social login styles
    const socialStyles = document.createElement('style');
    socialStyles.textContent = `
        .social-login {
            margin-top: 25px;
            text-align: center;
            position: relative;
        }
        
        .social-login::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            height: 1px;
            background-color: var(--border-color);
            z-index: 1;
        }
        
        .social-login-text {
            display: inline-block;
            background-color: #FFFFFF;
            padding: 0 15px;
            position: relative;
            z-index: 2;
            color: var(--text-medium);
            font-size: 0.9rem;
        }
        
        .social-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        
        .social-button {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #FFFFFF;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }
        
        .social-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
        }
        
        .social-google {
            background-color: #DB4437;
        }
        
        .social-facebook {
            background-color: #4267B2;
        }
        
        .social-twitter {
            background-color: #1DA1F2;
        }
    `;
    document.head.appendChild(socialStyles);
    
    // Social login HTML
    socialContainer.innerHTML = `
        <div class="social-login-text hindi">${document.body.getAttribute('data-lang') === 'hi' ? 'या इससे लॉगिन करें' : 'or login with'}</div>
        <div class="social-buttons">
            <button type="button" class="social-button social-google" title="Google">
                <i class="fab fa-google"></i>
            </button>
            <button type="button" class="social-button social-facebook" title="Facebook">
                <i class="fab fa-facebook-f"></i>
            </button>
            <button type="button" class="social-button social-twitter" title="Twitter">
                <i class="fab fa-twitter"></i>
            </button>
        </div>
    `;
    
    // Insert after the form
    loginForm.insertAdjacentElement('afterend', socialContainer);
    
    // Add click handlers
    const socialButtons = document.querySelectorAll('.social-button');
    socialButtons.forEach(button => {
        button.addEventListener('click', function() {
            // In a real app, this would redirect to OAuth provider
            const provider = this.classList.contains('social-google') ? 'Google' : 
                            this.classList.contains('social-facebook') ? 'Facebook' : 'Twitter';
            
            showNotification(
                document.body.getAttribute('data-lang') === 'hi' ? 'सोशल लॉगिन' : 'Social Login',
                document.body.getAttribute('data-lang') === 'hi' 
                    ? `${provider} लॉगिन अभी उपलब्ध नहीं है। कृपया यूजरनेम और पासवर्ड का उपयोग करें।` 
                    : `${provider} login is not available yet. Please use username and password.`,
                'info',
                3000
            );
        });
    });
}

// Initialize social login
addSocialLogin();

// Add animated background
function addAnimatedBackground() {
    // Create canvas element
    const canvas = document.createElement('canvas');
    canvas.className = 'background-canvas';
    
    // Add canvas styles
    const canvasStyles = document.createElement('style');
    canvasStyles.textContent = `
        .background-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.4;
        }
    `;
    document.head.appendChild(canvasStyles);
    
    // Insert canvas as first child of body
    document.body.insertBefore(canvas, document.body.firstChild);
    
    // Set canvas size
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    
    // Get context
    const ctx = canvas.getContext('2d');
    
    // Create particles
    const particles = [];
    const particleCount = 30;
    
    for (let i = 0; i < particleCount; i++) {
        particles.push({
            x: Math.random() * canvas.width,
            y: Math.random() * canvas.height,
            radius: Math.random() * 5 + 1,
            color: '#1B5E20',
            speedX: Math.random() * 0.5 - 0.25,
            speedY: Math.random() * 0.5 - 0.25
        });
    }
    
    // Animation function
    function animate() {
        // Check if reduce motion is enabled
        if (document.body.classList.contains('reduce-motion')) {
            return;
        }
        
        // Clear canvas
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Draw and update particles
        particles.forEach(particle => {
            // Draw particle
            ctx.beginPath();
            ctx.arc(particle.x, particle.y, particle.radius, 0, Math.PI * 2);
            ctx.fillStyle = particle.color;
            ctx.globalAlpha = 0.2;
            ctx.fill();
            
            // Update position
            particle.x += particle.speedX;
            particle.y += particle.speedY;
            
            // Boundary check
            if (particle.x < 0 || particle.x > canvas.width) {
                particle.speedX = -particle.speedX;
            }
            
            if (particle.y < 0 || particle.y > canvas.height) {
                particle.speedY = -particle.speedY;
            }
        });
        
        // Draw connections
        ctx.beginPath();
        for (let i = 0; i < particles.length; i++) {
            for (let j = i + 1; j < particles.length; j++) {
                const dx = particles[i].x - particles[j].x;
                const dy = particles[i].y - particles[j].y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                
                if (distance < 100) {
                    ctx.moveTo(particles[i].x, particles[i].y);
                    ctx.lineTo(particles[j].x, particles[j].y);
                }
            }
        }
        ctx.strokeStyle = '#1B5E20';
        ctx.globalAlpha = 0.05;
        ctx.stroke();
        
        // Request next frame
        requestAnimationFrame(animate);
    }
    
    // Start animation
    animate();
    
    // Resize canvas on window resize
    window.addEventListener('resize', function() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
    });
}

// Initialize animated background
addAnimatedBackground();

// Add guided tour functionality
function addGuidedTour() {
    // Create tour button
    const tourButton = document.createElement('button');
    tourButton.className = 'tour-button';
    tourButton.innerHTML = '<i class="fas fa-info-circle"></i>';
    tourButton.setAttribute('aria-label', document.body.getAttribute('data-lang') === 'hi' ? 'गाइडेड टूर' : 'Guided Tour');
    tourButton.title = document.body.getAttribute('data-lang') === 'hi' ? 'गाइडेड टूर शुरू करें' : 'Start Guided Tour';
    
    // Add tour styles
    const tourStyles = document.createElement('style');
    tourStyles.textContent = `
        .tour-button {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #FFFFFF;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .tour-button:hover {
            transform: scale(1.1);
            background-color: var(--primary-color);
            color: #FFFFFF;
        }
        
        .tour-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            display: none;
        }
        
        .tour-highlight {
            position: absolute;
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.7);
            border-radius: 4px;
            z-index: 2001;
            pointer-events: none;
        }
        
        .tour-tooltip {
            position: absolute;
            background-color: #FFFFFF;
            border-radius: 8px;
            padding: 15px;
            width: 250px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 2002;
            transition: all 0.3s ease;
        }
        
        .tour-tooltip-header {
            font-weight: 600;
            font-size: 1.1rem;
            color: var(--primary-color);
            margin-bottom: 8px;
        }
        
        .tour-tooltip-content {
            font-size: 0.9rem;
            color: var(--text-medium);
            margin-bottom: 15px;
        }
        
        .tour-tooltip-buttons {
            display: flex;
            justify-content: space-between;
        }
        
        .tour-button-next, .tour-button-prev, .tour-button-close {
            padding: 8px 12px;
            border-radius: 4px;
            font-size: 0.85rem;
            cursor: pointer;
            border: none;
            transition: all 0.3s ease;
        }
        
        .tour-button-next {
            background-color: var(--primary-color);
            color: #FFFFFF;
        }
        
        .tour-button-next:hover {
            background-color: var(--secondary-color);
        }
        
        .tour-button-prev {
            background-color: #E0E0E0;
            color: var(--text-dark);
        }
        
        .tour-button-prev:hover {
            background-color: #BDBDBD;
        }
        
        .tour-button-close {
            background-color: transparent;
            color: var(--text-medium);
        }
        
        .tour-button-close:hover {
            color: var(--text-dark);
            text-decoration: underline;
        }
        
        .tour-progress {
            display: flex;
            justify-content: center;
            margin-bottom: 12px;
        }
        
        .tour-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #E0E0E0;
            margin: 0 4px;
        }
        
        .tour-dot.active {
            background-color: var(--primary-color);
        }
    `;
    document.head.appendChild(tourStyles);
    
    document.body.appendChild(tourButton);
    
    // Create tour overlay elements
    const tourOverlay = document.createElement('div');
    tourOverlay.className = 'tour-overlay';
    
    const tourHighlight = document.createElement('div');
    tourHighlight.className = 'tour-highlight';
    
    const tourTooltip = document.createElement('div');
    tourTooltip.className = 'tour-tooltip';
    
    document.body.appendChild(tourOverlay);
    document.body.appendChild(tourHighlight);
    document.body.appendChild(tourTooltip);
    
    // Define tour steps
    const tourSteps = [
        {
            element: '#username',
            title: document.body.getAttribute('data-lang') === 'hi' ? 'यूजरनेम फील्ड' : 'Username Field',
            content: document.body.getAttribute('data-lang') === 'hi' 
                ? 'अपना यूजरनेम यहां दर्ज करें।' 
                : 'Enter your username here.',
            position: 'bottom'
        },
        {
            element: '#password',
            title: document.body.getAttribute('data-lang') === 'hi' ? 'पासवर्ड फील्ड' : 'Password Field',
            content: document.body.getAttribute('data-lang') === 'hi' 
                ? 'अपना पासवर्ड यहां दर्ज करें। आप आंख आइकन पर क्लिक करके पासवर्ड दिखा/छिपा सकते हैं।' 
                : 'Enter your password here. You can click the eye icon to show/hide the password.',
            position: 'bottom'
        },
        {
            element: '#rememberMe',
            title: document.body.getAttribute('data-lang') === 'hi' ? 'मुझे याद रखें' : 'Remember Me',
            content: document.body.getAttribute('data-lang') === 'hi' 
                ? 'इस विकल्प को चुनें अगर आप चाहते हैं कि आपका लॉगिन सेशन याद रखा जाए।' 
                : 'Check this option if you want your login session to be remembered.',
            position: 'right'
        },
        {
            element: 'button[type="submit"]',
            title: document.body.getAttribute('data-lang') === 'hi' ? 'लॉगिन बटन' : 'Login Button',
            content: document.body.getAttribute('data-lang') === 'hi' 
                ? 'अपने खाते में प्रवेश करने के लिए यहां क्लिक करें।' 
                : 'Click here to access your account.',
            position: 'top'
        },
        {
            element: '.social-buttons',
            title: document.body.getAttribute('data-lang') === 'hi' ? 'सोशल लॉगिन' : 'Social Login',
            content: document.body.getAttribute('data-lang') === 'hi' 
                ? 'अपने सोशल मीडिया खातों से भी लॉगिन कर सकते हैं।' 
                : 'You can also login with your social media accounts.',
            position: 'top'
        }
    ];
    
    let currentStep = 0;
    
    // Function to show tour step
    function showTourStep(stepIndex) {
        const step = tourSteps[stepIndex];
        const element = document.querySelector(step.element);
        
        if (!element) {
            console.error('Tour element not found:', step.element);
            return;
        }
        
        // Position highlight
        const rect = element.getBoundingClientRect();
        tourHighlight.style.top = rect.top + 'px';
        tourHighlight.style.left = rect.left + 'px';
        tourHighlight.style.width = rect.width + 'px';
        tourHighlight.style.height = rect.height + 'px';
        tourHighlight.style.display = 'block';
        
        // Create tooltip content
        let tooltipContent = `
            <div class="tour-tooltip-header">${step.title}</div>
            <div class="tour-tooltip-content">${step.content}</div>
            <div class="tour-progress">
                ${tourSteps.map((_, i) => 
                    `<div class="tour-dot${i === stepIndex ? ' active' : ''}"></div>`
                ).join('')}
            </div>
            <div class="tour-tooltip-buttons">
                ${stepIndex > 0 
                    ? `<button class="tour-button-prev">${document.body.getAttribute('data-lang') === 'hi' ? 'पिछला' : 'Previous'}</button>` 
                    : `<button class="tour-button-close">${document.body.getAttribute('data-lang') === 'hi' ? 'बंद करें' : 'Close'}</button>`}
                ${stepIndex < tourSteps.length - 1 
                    ? `<button class="tour-button-next">${document.body.getAttribute('data-lang') === 'hi' ? 'अगला' : 'Next'}</button>` 
                    : `<button class="tour-button-next">${document.body.getAttribute('data-lang') === 'hi' ? 'समाप्त करें' : 'Finish'}</button>`}
            </div>
        `;
        
        tourTooltip.innerHTML = tooltipContent;
        
        // Position tooltip
        let tooltipTop, tooltipLeft;
        
        switch (step.position) {
            case 'top':
                tooltipTop = rect.top - tourTooltip.offsetHeight - 10;
                tooltipLeft = rect.left + (rect.width / 2) - (tourTooltip.offsetWidth / 2);
                break;
            case 'bottom':
                tooltipTop = rect.bottom + 10;
                tooltipLeft = rect.left + (rect.width / 2) - (tourTooltip.offsetWidth / 2);
                break;
            case 'left':
                tooltipTop = rect.top + (rect.height / 2) - (tourTooltip.offsetHeight / 2);
                tooltipLeft = rect.left - tourTooltip.offsetWidth - 10;
                break;
            case 'right':
                tooltipTop = rect.top + (rect.height / 2) - (tourTooltip.offsetHeight / 2);
                tooltipLeft = rect.right + 10;
                break;
            default:
                tooltipTop = rect.bottom + 10;
                tooltipLeft = rect.left;
        }
        
        // Ensure tooltip stays within viewport
        if (tooltipLeft < 10) tooltipLeft = 10;
        if (tooltipLeft + tourTooltip.offsetWidth > window.innerWidth - 10) {
            tooltipLeft = window.innerWidth - tourTooltip.offsetWidth - 10;
        }
        
        if (tooltipTop < 10) tooltipTop = 10;
        if (tooltipTop + tourTooltip.offsetHeight > window.innerHeight - 10) {
            tooltipTop = window.innerHeight - tourTooltip.offsetHeight - 10;
        }
        
        tourTooltip.style.top = tooltipTop + 'px';
        tourTooltip.style.left = tooltipLeft + 'px';
        tourTooltip.style.display = 'block';
        
        // Add event listeners to buttons
        const nextButton = tourTooltip.querySelector('.tour-button-next');
        const prevButton = tourTooltip.querySelector('.tour-button-prev');
        const closeButton = tourTooltip.querySelector('.tour-button-close');
        
        if (nextButton) {
            nextButton.addEventListener('click', function() {
                if (stepIndex < tourSteps.length - 1) {
                    showTourStep(stepIndex + 1);
                } else {
                    endTour();
                }
            });
        }
        
        if (prevButton) {
            prevButton.addEventListener('click', function() {
                showTourStep(stepIndex - 1);
            });
        }
        
        if (closeButton) {
            closeButton.addEventListener('click', endTour);
        }
    }
    
    // Function to start tour
    function startTour() {
        tourOverlay.style.display = 'block';
        currentStep = 0;
        showTourStep(currentStep);
        
        // Save that user has seen the tour
        localStorage.setItem('tour_completed', 'true');
    }
    
    // Function to end tour
    function endTour() {
        tourOverlay.style.display = 'none';
        tourHighlight.style.display = 'none';
        tourTooltip.style.display = 'none';
    }
    
    // Add click handler to tour button
    tourButton.addEventListener('click', startTour);
    
    // Show tour automatically on first visit
    if (!localStorage.getItem('tour_completed')) {
        // Delay to ensure page is fully loaded
        setTimeout(startTour, 1500);
    }
}

// Initialize guided tour
addGuidedTour();

// Add custom date/time display
function addDateTimeDisplay() {
    // Create date/time container
    const dateTimeContainer = document.createElement('div');
    dateTimeContainer.className = 'date-time-display';
    
    // Add date/time styles
    const dateTimeStyles = document.createElement('style');
    dateTimeStyles.textContent = `
        .date-time-display {
            position: absolute;
            top: 15px;
            left: 15px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 20px;
            padding: 5px 12px;
            font-size: 0.8rem;
            color: var(--text-dark);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
        }
        
        .date-time-display i {
            margin-right: 5px;
            color: var(--primary-color);
        }
    `;
    document.head.appendChild(dateTimeStyles);
    
    // Add to header
    const header = document.querySelector('.header');
    header.style.position = 'relative';
    header.appendChild(dateTimeContainer);
    
    // Function to update date/time
    function updateDateTime() {
        const now = new Date();
        const options = { 
            weekday: 'long', 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric',
            hour: '2-digit',
            minute: '2-digit'
        };
        
        const locale = document.body.getAttribute('data-lang') === 'hi' ? 'hi-IN' : 'en-US';
        const formattedDate = now.toLocaleDateString(locale, options);
        
        dateTimeContainer.innerHTML = `<i class="fas fa-calendar-alt"></i> ${formattedDate}`;
    }
    
    // Update initially and then every minute
    updateDateTime();
    setInterval(updateDateTime, 60000);
}

// Initialize date/time display
addDateTimeDisplay();

// Add loading spinner for page transitions
function setupPageTransitions() {
    // Create loading overlay
    const loadingOverlay = document.createElement('div');
    loadingOverlay.className = 'loading-overlay';
    loadingOverlay.innerHTML = `
        <div class="loading-spinner">
            <div class="spinner"></div>
            <div class="loading-text hindi">${document.body.getAttribute('data-lang') === 'hi' ? 'लोड हो रहा है...' : 'Loading...'}</div>
        </div>
    `;
    
    // Add loading styles
    const loadingStyles = document.createElement('style');
    loadingStyles.textContent = `
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.9);
            z-index: 3000;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0s linear 0.3s;
        }
        
        .loading-overlay.show {
            opacity: 1;
            visibility: visible;
            transition: opacity 0.3s ease, visibility 0s;
        }
        
        .loading-spinner {
            text-align: center;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(27, 94, 32, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        .loading-text {
            color: var(--primary-color);
            font-weight: 600;
        }
        
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
    `;
    document.head.appendChild(loadingStyles);
    
    document.body.appendChild(loadingOverlay);
    
    // Show loading on page navigation
    document.addEventListener('click', function(event) {
        const target = event.target.closest('a');
        if (target && target.href && !target.getAttribute('download') && 
            !target.getAttribute('target') && 
            target.hostname === window.location.hostname) {
            
            event.preventDefault();
            
            loadingOverlay.classList.add('show');
            
            setTimeout(() => {
                window.location.href = target.href;
            }, 500);
        }
    });
    
    // Show loading on form submission
    document.getElementById('loginForm').addEventListener('submit', function(event) {
        if (this.checkValidity()) {
            loadingOverlay.classList.add('show');
        }
    });
}

// Initialize page transitions
setupPageTransitions();

// Add print styles
function addPrintStyles() {
    const printStyles = document.createElement('style');
    printStyles.textContent = `
        @media print {
            body {
                background-color: #FFFFFF !important;
            }
            
            .header, .feedback-button, .theme-switcher, .accessibility-button, 
            .language-switcher, .tour-button, .connection-indicator, 
            .background-canvas, .loading-overlay {
                display: none !important;
            }
            
            .card {
                box-shadow: none !important;
                border: 1px solid #CCCCCC !important;
                width: 100% !important;
                max-width: none !important;
                margin: 0 !important;
            }
            
            .card-header {
                color: #000000 !important;
                background: #EEEEEE !important;
            }
            
            .login-container {
                padding: 0 !important;
                min-height: auto !important;
                display: block !important;
            }
            
            .form-control, .btn-primary {
                border: 1px solid #000000 !important;
            }
            
            /* Add a QR code for mobile access */
            .auth-footer::after {
                content: 'Scan to access on mobile';
                display: block;
                margin-top: 20px;
                text-align: center;
                font-weight: bold;
            }
        }
    `;
    document.head.appendChild(printStyles);
}

// Initialize print styles
addPrintStyles();

// Final initialization - register service worker for PWA support
if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
        navigator.serviceWorker.register('/service-worker.js').then(function(registration) {
            console.log('ServiceWorker registration successful with scope: ', registration.scope);
        }, function(err) {
            console.log('ServiceWorker registration failed: ', err);
        });
    });
}

// Add manifest for PWA
const manifestLink = document.createElement('link');
manifestLink.rel = 'manifest';
manifestLink.href = '/manifest.json';
document.head.appendChild(manifestLink);

// Console welcome message
console.log(
    '%c कृषि पोर्टल - Agriculture Portal',
    'color: #1B5E20; font-size: 20px; font-weight: bold;'
);
console.log(
    '%c Powered by Forest Green & Cream Theme with Mukta Devanagari font',
    'color: #388E3C; font-size: 12px;'
);

// Add version info in footer
function addVersionInfo() {
    const versionInfo = document.createElement('div');
    versionInfo.className = 'version-info';
    versionInfo.textContent = 'v1.0.0';
    
    // Add version styles
    const versionStyles = document.createElement('style');
    versionStyles.textContent = `
        .version-info {
            position: absolute;
            bottom: 5px;
            right: 5px;
            font-size: 0.7rem;
            color: rgba(0, 0, 0, 0.3);
            pointer-events: none;
        }
    `;
    document.head.appendChild(versionStyles);
    
    // Add to login container
    document.querySelector('.login-container').style.position = 'relative';
    document.querySelector('.login-container').appendChild(versionInfo);
}

// Initialize version info
addVersionInfo();

// Add easter egg
const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
let konamiIndex = 0;

document.addEventListener('keydown', function(e) {
    // Reset if the key doesn't match what we're looking for
    if (e.key !== konamiCode[konamiIndex]) {
        konamiIndex = 0;
        return;
    }
    
    // Move to the next key in the sequence
    konamiIndex++;
    
    // If the full sequence is entered, trigger the easter egg
    if (konamiIndex === konamiCode.length) {
        activateEasterEgg();
        konamiIndex = 0;
    }
});

function activateEasterEgg() {
    // Create and add confetti styles
    const confettiStyles = document.createElement('style');
    confettiStyles.textContent = `
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #1B5E20;
            opacity: 0.7;
            animation: confetti-fall 4s ease-in-out forwards;
        }
        
        @keyframes confetti-fall {
            0% {
                transform: translateY(-100px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }
    `;
    document.head.appendChild(confettiStyles);
    
    // Create confetti
    for (let i = 0; i < 100; i++) {
        setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            confetti.style.left = `${Math.random() * 100}%`;
            confetti.style.backgroundColor = getRandomColor();
            confetti.style.animationDuration = `${3 + Math.random() * 3}s`;
            document.body.appendChild(confetti);
            
            // Remove after animation completes
            setTimeout(() => {
                confetti.remove();
            }, 6000);
        }, i * 30);
    }
    
    // Show easter egg message
    showNotification(
        'Easter Egg Found!',
        document.body.getAttribute('data-lang') === 'hi' 
            ? 'आपने गुप्त कोड खोज लिया है!' 
            : 'You discovered the secret code!',
        'success',
        5000
    );
    
    // Get random color
    function getRandomColor() {
        const colors = ['#1B5E20', '#388E3C', '#8BC34A', '#FFF8E1', '#4CAF50'];
        return colors[Math.floor(Math.random() * colors.length)];
    }
}

// Add browser-specific optimizations
function applyBrowserOptimizations() {
    // Detect browser
    const ua = navigator.userAgent;
    const isChrome = /Chrome/.test(ua) && !/Edge/.test(ua) && !/Edg/.test(ua);
    const isFirefox = /Firefox/.test(ua);
    const isSafari = /Safari/.test(ua) && !/Chrome/.test(ua);
    const isEdge = /Edge/.test(ua) || /Edg/.test(ua);
    
    // Add browser-specific classes
    if (isChrome) document.body.classList.add('browser-chrome');
    if (isFirefox) document.body.classList.add('browser-firefox');
    if (isSafari) document.body.classList.add('browser-safari');
    if (isEdge) document.body.classList.add('browser-edge');
    
    // Add browser-specific styles
    const browserStyles = document.createElement('style');
    browserStyles.textContent = `
        /* Firefox-specific styles */
        .browser-firefox .form-control {
            scrollbar-width: thin;
            scrollbar-color: var(--primary-color) var(--background-light);
        }
        
        /* Safari-specific styles */
        .browser-safari .card {
            transform: translateZ(0); /* Force GPU acceleration */
        }
        
        /* Edge-specific styles */
        .browser-edge .form-control::placeholder {
            opacity: 0.7;
        }
    `;
    document.head.appendChild(browserStyles);
}

// Apply browser optimizations
applyBrowserOptimizations();

// Add schema markup for SEO
function addSchemaMarkup() {
    const schemaScript = document.createElement('script');
    schemaScript.type = 'application/ld+json';
    
    const schemaData = {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "कृषि पोर्टल - Agriculture Portal",
        "applicationCategory": "Government",
        "operatingSystem": "All",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "INR"
        }
    };
    
    schemaScript.textContent = JSON.stringify(schemaData);
    document.head.appendChild(schemaScript);
}

// Add schema markup
addSchemaMarkup();

// Add support for autocomplete
function enhanceFormAutocomplete() {
    // Set appropriate autocomplete attributes
    const usernameField = document.getElementById('username');
    const passwordField = document.getElementById('password');
    
    if (usernameField) {
        usernameField.setAttribute('autocomplete', 'username');
    }
    
    if (passwordField) {
        passwordField.setAttribute('autocomplete', 'current-password');
    }
}

// Initialize autocomplete enhancement
enhanceFormAutocomplete();

// Add support for password managers
function enhancePasswordManagerSupport() {
    // Add form identification for password managers
    const loginForm = document.getElementById('loginForm');
    
    if (loginForm) {
        loginForm.setAttribute('name', 'loginForm');
        loginForm.setAttribute('data-form-type', 'login');
    }
    
    // Add login hint for password managers
    const loginHint = document.createElement('meta');
    loginHint.name = 'google-site-verification';
    loginHint.content = 'login-form';
    document.head.appendChild(loginHint);
}

// Initialize password manager support
enhancePasswordManagerSupport();

// Initialize all enhancements
document.addEventListener('DOMContentLoaded', function() {
    console.log('All enhancements initialized successfully.');
});







